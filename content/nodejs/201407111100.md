Status: draft
Title: nodejs + express ディスパッチャを集約したい。
Date: 2014-07-11 11:00
Category: nodejs
Tags: nodejs, express
Slug: nodejsexpressdispatch
Author: youske
Summary: nodejs+express環境ディスパッチャを集約したい。

# はじめに
やりたいことの定義
1. すべてのURLは一つのディスパッチャにて割り振りたい
2. 

databaseへの読み書きを直接行うよりもORMを利用すると何かと便利そうです。
nodejsの中でも幾つかORMのソフトウェアはありますが、adapterが用意されているjugglingDBを利用します。

# コード
おおむね次のような感じ

'''
var Schema = require('jugglingdb').Schema;


var testmodel = shema.define( 'Test',{

});
schema.autoupdate();

testmodel.create();


'''

# express セッション
redisをセッションキャッシュにする。



npm install connect-redis

RedisStore = require('connect-redis')(express);

app.use(express.cookieParser());
app.use(express.session({
  secret:"oyoyoyoyo",
  store:new RedisStore(),
  cookie: {maxAge: 86400 * 1000}
});
app.use(app.router);






一応構想

appサーバはpm2によるプロセスの管理を利用する。
セッションキャッシュ


